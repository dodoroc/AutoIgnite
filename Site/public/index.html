<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, shrink-to-fit=no"><!-- , viewport-fit=cover"> -->
    <link rel="icon" type="image/x-icon" href="data:,">
    <!-- <link rel="icon" href="data:image/gif;base64,R0lGODlhASABICAgIDs="> -->
    <link rel="stylesheet" href="/assets/base.css">

    <title>AutoIgnite Dashboard</title>

    <style>
      /*
      firebrick #b22222
      floralwhite #fffaf0
      ivory #fffff0
      maroon  #800000
      papayawhip  #ffefd5
      snow  #fffafa
      */

      h1 {
        margin: 0;
        padding: 0;
      }
      body > h1 {
        height: 1lh;
        line-height: 1lh;
        font-size: var(--font-size-h1);
      }






      search.aute {
        display: grid;
        grid-template: auto auto auto / 1fr min-content;
        gap: 10px;

        & .span-all-columns {
          grid-column: 1 / -1;
        }

        & .sorting {
          display: flex;
          flex-flow: row nowrap;
          gap: 10px;
        }

        & .counts {
          line-height: 0.77lh;
        }
      }

      search.aute .sorting .info-abbr::before {
        margin: inherit 0.67ch;
      }

      table.aute {
        & :where(.nm, .ao, .wo, .sk) { width: auto }
        & .nm { width: 100% }

        & tr td:last-of-type {
          text-align: right;
        }

        & td[colspan] {
          text-align: center !important;
        }
      }
    </style>

    <script type="module" src="/assets/app.mjs"></script>
  </head>
  <body @vue:mounted="mounted" cloak>

    <h1>AutoIgnite Dashboard</h1>

    <search class="aute" id="aute-filters" @submit.prevent @input="filterParamsChanged" @change="filterParamsChanged">
      <!--
      <select class="span-all-clumns" name="filter-seriesid" v-model="model.source.seriesId">
        <option v-for="series in model.source.series" :value="series.seriesId">
          {{series.name}} ({{series.releaseYear}})
        </option>
      </select>
      -->

      <button class="select-box span-all-columns" role="listbox" popovertarget="select-box-popover-sk443f">
        <span popover id="select-box-popover-sk443f"></span>
        <span class="message">Select series</span>
        <span class="items">
          <label v-for="series in model.source.series">
            <input
              type="radio"
              name="filter-seriesid"
              :value="series.seriesId"
              v-model="model.source.seriesId"
            >{{series.name}} ({{series.releaseYear}})
          </label>
        </span>
      </button>

      <input
        type="text" maxlength="30" spellcheck="false" autocorrect="off" autofocus
        placeholder="Filter program name (regex allowed)"
        name="filter-name"
        v-model="model.filter.params.name"
      >

      <label class="ckrd-marg ckrd-left">Unwatched only<input class="switch" type="checkbox" name="filter-unwatched" v-model="model.filter.params.unwatched"></label>

      <div class="sorting span-all-columns ckrd-marg ckrd-right">
        Sort by
        <label><input type="radio" name="sorted" value="df">default</label>
        <label><input type="radio" name="sorted" value="ky">SE<i class="info-abbr" title="Season and episode key"></i>key</label>
        <label><input type="radio" name="sorted" value="da">aired on</label>
        <label><input type="radio" name="sorted" value="dw">watched on</label>
      </div>

      <span class="counts span-all-columns">Found: {{model.source.count}} │ Filtered: {{model.filter.count}}</span>
    </search>


    <div class="hscroll-overflow">
      <table class="aute" id="aute-results">
        <colgroup><col class="nm"><col class="ao"><col class="wo"><col class="sk"></colgroup>

        <thead>
          <tr><td>Name</td><td>Aired On</td><td>Watched</td><td>Key</td></tr>
        </thead>

        <tbody v-if="model.filter.results.length">
          <tr v-for="program in model.filter.results" :key="model.source.seriesId+'-'+program.seepKey">
            <td>{{program.name}}</td>
            <td>{{program.airedOn}}</td>
            <td>{{program.watchedOn}}</td>
            <td>{{seep(program.seepKey)}}</td>
          </tr>
        </tbody>

        <tbody v-else>
          <tr><td colspan="10">Nothing to show</td></tr>
        </tbody>
      </table>
    </div>

    <div id="spinner">LOADING</div>

  </body>
</html>
